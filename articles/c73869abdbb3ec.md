---
title: "ã‚¶ãƒˆã‚¦ã‚¯ã‚¸ãƒ©ã®æ­Œã‚’åˆ†æã™ã‚‹"
emoji: "ğŸ¤–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["whale-song","analytics"]
published: true
---

# ã¯ã˜ã‚ã«
å†¬å­£ã«äº¤å°¾ãƒ»å‡ºç”£ãƒ»å­è‚²ã¦ã®ãŸã‚æ—¥æœ¬è¿‘æµ·ã¸è¨ªã‚Œã‚‹ã‚¶ãƒˆã‚¦ã‚¯ã‚¸ãƒ©ãŸã¡ã‚’è¦³å¯Ÿã™ã‚‹ãƒ›ã‚¨ãƒ¼ãƒ«ã‚¹ã‚¤ãƒ ãƒ„ã‚¢ãƒ¼ã«å‚åŠ ã—ã¦ãã¾ã—ãŸã€‚
ã‚¶ãƒˆã‚¦ã‚¯ã‚¸ãƒ©ã¯ã€å¤ã¯ãƒ­ã‚·ã‚¢ã€ã‚¢ãƒ©ã‚¹ã‚«ç­‰ã®é«˜ç·¯åº¦æµ·åŸŸã§é¤Œã‚’é£Ÿã¹ã€å†¬ã¯æ²–ç¸„ãƒ»ãƒãƒ¯ã‚¤ç­‰ã®ä½ç·¯åº¦æµ·åŸŸã§ç¹æ®–ã‚„å­è‚²ã¦ã‚’è¡Œã†ã“ã¨ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚
ç¹æ®–æµ·åŸŸã§ã¯ã€ã‚ªã‚¹ãŒé«˜éŸ³ãƒ»ä½éŸ³ã‚’çµ„ã¿åˆã‚ã›ãŸç‹¬ç‰¹ãªé³´ãå£°ã‚’ç™ºã—ã¾ã™ã€‚æ­Œã‚’ã†ãŸã†ã‚¯ã‚¸ãƒ©ã¯ã‚·ãƒ³ã‚¬ãƒ¼ã¨å‘¼ã°ã‚Œã¦ã„ã¦ã€ã‚·ãƒ³ã‚¬ãƒ¼ã®æ­Œã¯ãƒ›ã‚¨ãƒ¼ãƒ«ã‚½ãƒ³ã‚°ã¨å‘¼ã°ã‚Œã¦ã„ã¾ã™[^1]ã€‚
ä»Šå›ã®ãƒ„ã‚¢ãƒ¼ã§ã‚‚ã‚·ãƒ³ã‚¬ãƒ¼ã¨å‡ºä¼šã†ã“ã¨ãŒã§ãã€10åˆ†ã»ã©æ­Œã‚’è´ãã“ã¨ãŒã§ãã¾ã—ãŸã€‚

ãƒ›ã‚¨ãƒ¼ãƒ«ã‚½ãƒ³ã‚°ã«ã¯ã€çŸ­ã„éŸ³ã‹ã‚‰ãªã‚‹ã€Œãƒ¦ãƒ‹ãƒƒãƒˆï¼ˆunitï¼‰ã€ã€ãƒ¦ãƒ‹ãƒƒãƒˆã‚’çµ„ã¿åˆã‚ã›ãŸã€Œãƒ•ãƒ¬ãƒ¼ã‚ºï¼ˆphraseï¼‰ã€ã€è¤‡æ•°ã®ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’çµ„ã¿åˆã‚ã›ãŸã€Œãƒ†ãƒ¼ãƒï¼ˆthemeï¼‰ã€ãŒã‚ã‚Šã€è¤‡æ•°ã®ãƒ†ãƒ¼ãƒãŒçµ„ã¿åˆã‚ã•ã‚Œã‚‹ã“ã¨ã§ä¸€ã¤ã®ã€Œæ­Œã€ã¨ã„ã†æ§‹é€ ãŒã‚ã‚Šã¾ã™ã€‚ã•ã‚‰ã«ãã®æ­Œã«ã‚‚ã€å€‹ä½“ã«ã‚ˆã‚‹ä¸Šæ‰‹ä¸‹æ‰‹ãŒã‚ã£ãŸã‚Šã€åŒæµ·åŸŸã®ã‚·ãƒ³ã‚¬ãƒ¼ã¯é¡ä¼¼ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ­Œã‚’ã†ãŸã£ãŸã‚Šã€å¹´ã«ã‚ˆã£ã¦æµè¡Œã‚Šã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã£ãŸã‚Šã™ã‚‹ãã†ã§ã™ã€‚[^2]
ã“ã†ã—ãŸãƒ‡ãƒ¼ã‚¿ã®åˆ†æã¯éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®ã¾ã¾ã§ã¯ãªãã€ç”»åƒãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã—ãŸæ–¹ãŒæ‰±ã„æ˜“ããªã‚‹ã®ã§ã€ä»Šå›GoProã§æ’®å½±ã—ãŸå‹•ç”»ã‚’ä½¿ã£ã¦ãƒ›ã‚¨ãƒ¼ãƒ«ã‚½ãƒ³ã‚°ã®å¯è¦–åŒ–ã‚’è¡Œã£ã¦ã¿ã¾ã—ãŸã€‚

# ãƒ›ã‚¨ãƒ¼ãƒ«ã‚½ãƒ³ã‚°ã®å¯è¦–åŒ–

## å‹•ç”»ã‹ã‚‰ã®éŸ³å£°ãƒ‡ãƒ¼ã‚¿æŠ½å‡º

ä»Šå›ã®ä½œæ¥­ã¯ã€Apple M1 Chipã®Mac Miniã«ã¦è¡Œã£ã¦ã„ã¾ã™ã€‚

[ffmpeg](https://ffmpeg.org)ã‚’ä½¿ã£ã¦ã€GoProã§æ’®ã£ãŸmp4ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰mp3ãƒ‡ãƒ¼ã‚¿ã®æŠ½å‡ºã‚’è¡Œã„ã¾ã—ãŸã€‚

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```
brew install ffmpeg
```

å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®éŸ³å£°ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
```
ffmpeg -i ./2024whale/GX010497.MP4 -ab 256k ./2024whale/GX010497.mp3
```

## éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–

å¯è¦–åŒ–ã«ã¯ã€å‘¨æ³¢æ•°è»¸ãŒãƒ¡ãƒ«å°ºåº¦ã®ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã§ã‚ã‚‹ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã‚’åˆ©ç”¨ã—ã¾ã—ãŸã€‚
Jupyter Lab ã¨ Pythonã®éŸ³éŸ¿è§£æãŠã‚ˆã³ä¿¡å·å‡¦ç†ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹ [Librosa](https://librosa.org/doc/latest/index.html) ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚

Pythonã¨Jupyter Labã€Linrosaã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```
brew install pyenv
echo 'export PYENV_ROOT="$HOME/.pyenv"' >> ~/.zshrc
echo '[[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"' >> ~/.zshrc
echo 'eval "$(pyenv init -)"' >> ~/.zshrc
source ~/.zshrc
pyenv install 3.10.7
pyenv global 3.10.7
pip install jupyterlab
pip install librosa
jupyter lab
```

Jupyter Labã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¦å¯è¦–åŒ–ã—ã¾ã™
```python
import librosa
import librosa.display
import matplotlib.pyplot as plt
import numpy as np

file_name = './2024whale/GX010497.mp3'
y, sr = librosa.load(file_name, sr=None)
S = librosa.feature.melspectrogram(y=y, sr=sr)
S_dB = librosa.power_to_db(S, ref=np.max)

plt.figure(figsize=(90, 10))
librosa.display.specshow(S_dB, x_axis='time', y_axis='mel', sr=sr)
plt.colorbar(format='%+2.0f dB')
plt.title('Mel spectrogram')
plt.tight_layout()
plt.show()
```

# çµæœ

![mel_spec_audio1](/images/mel_spec_audio1.png)

![mel_spec_audio2](/images/mel_spec_audio2.png)


éŸ³å£°ã¨åˆã‚ã›ã¦
https://youtu.be/auAZiEr6aP0?si=Ve-XoKYux7JfZxzB

# ãŠã‚ã‚Šã«
ä»Šå›ã€æ•°ã¯å°‘ãªã„ãªãŒã‚‰ãƒ›ã‚¨ãƒ¼ãƒ«ã‚½ãƒ³ã‚°ã®å¯è¦–åŒ–ã‚’è¡Œã†ã“ã¨ã§ãƒ¦ãƒ‹ãƒƒãƒˆãƒ»ãƒ•ãƒ¬ãƒ¼ã‚ºãƒ»ãƒ†ãƒ¼ãƒã‹ã‚‰æˆã‚‹ã¨è¨€ã†ãƒ›ã‚¨ãƒ¼ãƒ«ã‚½ãƒ³ã‚°ã®æ§‹é€ ã‚’ç¢ºèªã—ãŸã‚Šï¼’é ­åˆ†ã®æ­Œã‚’è¦‹æ¯”ã¹ã‚‹ã“ã¨ãŒã§ãã‚‹æ§˜ã«ãªã‚Šã¾ã—ãŸã€‚
ã¾ãŸæ¥å¹´ã¯é•ã£ãŸæ­ŒãŒæµè¡Œã£ã¦ã„ã‚‹ã§ã—ã‚‡ã†ã—ã€ã‚¯ã‚¸ãƒ©ã®é ­æ•°å›å¾©ã«ä¼´ã„ã€æ­ŒãŒç¹æ®–æ©Ÿä¼šã‚’å¢—ã‚„ã™ãŸã‚ã®æœ€é©è§£ã§ã¯ãªããªã£ã¦ãã¦ã„ã‚‹åœ°åŸŸã‚‚ã‚ã‚‹ãã†ã§[^3] æ—¥æœ¬ã«æ¥ã‚‹ã‚¯ã‚¸ãƒ©ãŸã¡ã«ã©ã†ã„ã†å½±éŸ¿ãŒã‚ã‚‹ã‹ã‚‚èˆˆå‘³æ·±ã„ã§ã™ã€‚
ã‚¯ã‚¸ãƒ©ã¯ç‹¬è‡ªã®è¤‡é›‘ãªç¤¾ä¼šã‚’ç™ºé”ã•ã›ã¦ã€å‘¨å›²ã®çŠ¶æ³ã«å¿œã˜ã¦æŸ”è»Ÿã«å¤‰åŒ–ã—ã¦ã„ãç”Ÿãç‰©ãªã®ã§ã€ãã®å§¿ä»¥å¤–ã«æ­Œã«ã‚‚æ³¨ç›®ã—ã¦ãƒ›ã‚¨ãƒ¼ãƒ«ã‚¦ã‚©ãƒƒãƒãƒ³ã‚°ãƒ»ã‚¹ã‚¤ãƒ ã‚’æ¥½ã—ã‚“ã§ã„ã‘ã‚Œã°ãªã¨æ€ã„ã¾ã™ã€‚

[^1]: https://churashima.okinawa/sp/userfiles/files/zatoukujira_all_20151127.pdf
[^2]: https://royalsocietypublishing.org/doi/10.1098/rsos.220158
[^3]: https://www.nature.com/articles/s42003-023-04509-7